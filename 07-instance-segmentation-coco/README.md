# 專案 07：COCO 實例分割 (Mask R-CNN) 總結

## 專案目標
本專案是我的學習計畫中，技術整合度最高、最具挑戰性的頂點專案。目標是掌握**實例分割 (Instance Segmentation)** 的完整工作流程。這項任務要求模型不僅要像物件偵測一樣定位和分類物體，還要像語意分割一樣為**每一個獨立的物體實例**描繪出像素級的精確輪廓。

## 使用資料集
* **名稱**: COCO 2017 (Common Objects in Context)
* **任務類型**: 多類別實例分割，是電腦視覺領域最權威、最複雜的基準資料集之一。
* **關鍵標註格式**: 一個大型、結構化的 **`.json` 檔案**。我學會了如何解析這個業界標準格式，理解其中定義的圖片 (`images`)、類別 (`categories`) 和標註 (`annotations`) 之間的關聯。

## 我學到的關鍵技術

1.  **COCO 資料集工具與格式**:
    * 我掌握了使用官方函式庫 **`pycocotools`** 來高效地載入、解析和查詢複雜 `annotations.json` 檔案的方法。
    * 我學會了使用 `torchvision` 內建的高階 `torchvision.datasets.CocoDetection` Dataset，這大大簡化了與標準資料集的對接流程。

2.  **進階資料轉換 (Advanced Data Wrangling)**:
    * 這是我在此專案中的一個核心收穫。我發現並成功解決了 `CocoDetection` 的輸出格式（字典的列表）與 `Mask R-CNN` 模型期望的輸入格式（包含 Tensor 的單一字典）之間的「鴻溝」。
    * 我為此在訓練迴圈中，親手編寫了一個即時的資料轉換邏輯，能正確處理邊界框格式轉換、遮罩生成，以及「負樣本」（沒有任何標註的圖片）的特殊情況。

3.  **Mask R-CNN 模型微調**:
    * 我理解了 Mask R-CNN 是在 Faster R-CNN 基礎上增加「遮罩預測頭 (Mask Head)」的進階模型。
    * 我掌握了微調預訓練 Mask R-CNN 的正確流程：同時替換**框線預測頭 (Box Predictor)** 和**遮罩預測頭 (Mask Predictor)**，以適應我們自訂的類別數量。

4.  **偵錯複雜錯誤**:
    * 在這個專案中，我成功地診斷並解決了多個專業級的錯誤，包括 `torchvision` API 的權重版本不匹配 (`TypeError`, `KeyError`)，以及因資料處理不當導致的 `IndexError`，大幅提升了我的獨立偵錯能力。

## 最終成果
* 我成功地搭建並訓練了一個完整的、端到端的實例分割管道。
* 模型的訓練過程順利完成，損失值 (Loss) 呈現穩定的下降趨勢，證明我所建構的複雜資料處理流程與模型改造是完全正確的。
* 我成功地將模型的預測結果視覺化，能在一張圖片上同時顯示其預測的邊界框和像素級的彩色遮罩，直觀地驗證了模型的學習成果。

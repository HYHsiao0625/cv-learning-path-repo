# 專案 03：Global Wheat Detection 總結

## 專案目標
本專案是您從「影像分類」**跨越**到「**物件偵測**」的第一個實戰專案。核心目標是學習物件偵測的完整端到端工作流程，透過一個相對單純的**單類別偵測**任務（只找麥穗），來建立所有必需的基礎概念和程式碼實作能力。

#### **使用資料集**
* **名稱**: Global Wheat Detection (Kaggle)
* **關鍵特性**:
    * **單類別**: 資料集中唯一的偵測目標是 `wheat head` (麥穗)。
    * **CSV 標註格式**: 所有圖片的標註資訊（圖片 ID、邊界框座標）都統一儲存在一個 `train.csv` 檔案中。

## 學習到的關鍵技術

1.  **物件偵測基礎概念入門**:
    * 首次將「標籤」的概念從單一的**類別**，擴展為包含位置資訊的**邊界框 (Bounding Box)**。
    * 初步學習了物件偵測的評估標準 **IoU (Intersection over Union)**，並理解了它是衡量預測框與真實框重疊程度的標準。

2.  **建立第一個客製化 PyTorch `Dataset`**:
    * 這是本專案**最重要的技術突破**。您成功地從零開始，撰寫了一個繼承 `torch.utils.data.Dataset` 的 `WheatDataset` 類別。
    * 掌握了 `__init__`, `__len__`, `__getitem__` 這三個核心方法的實作。
    * 學會了如何使用 `pandas` 讀取 `.csv` 標註檔，並在 `__getitem__` 中根據索引 `idx` 動態地找到對應圖片及其所有的邊界框。

3.  **物件偵測模型的遷移學習**:
    * 首次使用了 `torchvision.models.detection` 中的預訓練模型 (`fasterrcnn_resnet50_fpn`)。
    * 掌握了為偵測模型進行微調的便捷方法：在載入模型時直接傳入 `num_classes` 參數，PyTorch 會自動替換掉模型的「分類頭」。
    * 理解了 `num_classes` 必須設定為 `實際類別數 + 1` (背景) 的規則。

4.  **理解 mAP 評估指標**:
    * 首次接觸到了物件偵測領域的黃金標準 **mAP (mean Average Precision)**。
    * 學會了如何使用 `torchmetrics` 函式庫來進行專業的模型評估，並能初步解讀 `map` 和 `map_50` 等不同指標的意義。

## 最終成果與分析
* **基準模型 (Baseline Model)**：透過遷移學習，模型成功地學會了在圖片中定位麥穗的位置。在訓練 5 個 Epochs 後，模型在驗證集上取得了以下成果：
    * **`mAP @ IoU=0.50`**: `0.8875` (約 89%)
    * **`mAP @ IoU=0.50:0.95` (主要指標)**: `0.4655` (約 47%)
* **成果分析**: 這個專案的成功不在於最終的 mAP 分數高低，而在於您**成功地搭建了整個物件偵測的管道 (pipeline)**。從解析一種全新的資料格式，到建立一個能處理它的複雜 `Dataset`，再到訓練和評估，您驗證了自己有能力應對一個完整的偵測任務。